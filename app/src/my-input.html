<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="paper-time-picker.html">
<link rel="import" href="menu-overlay.html">
<link rel="import" href="paper-clock-selector.html">
<link rel="import" href="simple-menu.html">
<link rel="import" href="simple-menubar.html">
<link rel="import" href="my-animatable.html">
<link rel="import" href="my-animatable-triangle.html">
<link rel="import" href="my-icons.html">
<link rel="import" href="../bower_components/paper-tooltip/paper-tooltip.html">

<link rel="import" href="../bower_components/platinum-sw/platinum-sw-elements.html">
<link rel="import" href="../bower_components/polymerfire/firebase-app.html">
<link rel="import" href="../bower_components/app-storage/app-indexeddb-mirror/app-indexeddb-mirror.html">
<link rel="import" href="../bower_components/polymerfire/polymerfire.html">
<dom-module id="my-input">

  <template>

    <style>
      :host {
        display: block;
        padding: 10px;
      }

      simple-menu,
    simple-menubar {
      display: inline-block;
      width: 100%;
    }

    simple-menu a {
      display: block;
    }

    simple-menubar a,
    simple-menu a {
      padding: 15px 20px;
      color: var(--primary-text-color);
      text-decoration: none;
    }

    p.heading {
      color: var(--app-primary-color);
      text-decoration: none;
      margin-bottom:0px;
    }

    simple-menu a[disabled],
    simple-menubar a[disabled] {
      color: var(--google-grey-300);
    }

    .horizontal-section {
      padding: 0;
      margin-bottom: 20px;
    }

    .row {
      height: 100px;
    }

    .menuitem-floating {
      float:left; 
      display:inline;
      margin: 20px;
    }
    </style>

    <platinum-sw-register
        auto-register
        skip-waiting
        clients-claim
        reload-on-install
        href="sw-import.js">
      <platinum-sw-cache
          default-cache-strategy="networkFirst">
      </platinum-sw-cache>
    </platinum-sw-register>

    <firebase-app
        name="beAware"
        api-key="AIzaSyDyR8rI9pbiTrwoP-uRRc39iuXyzN5Kdoc"
        auth-domain="beaware-140408.firebaseapp.com"
        database-url="https://beaware-140408.firebaseio.com">
    </firebase-app>

    <firebase-auth
        id="auth"
        app-name="beAware"
        provider="google"
        signed-in="{{signedIn}}"
        user="{{user}}">
    </firebase-auth>
        <!-- <paper-icon-button id="id_1" icon="menu" alt="heart"></paper-icon-button> -->
    <!-- <paper-tooltip for="id_1" offset="0">&lt;3 &lt;3 &lt;3 </paper-tooltip> -->

    <div id="scope">
            <paper-time-picker id="picker" period-start-selected="{{periodStartSelected}}" period-end-selected="{{periodEndSelected}}"></paper-time-picker>
    </div>

    <!-- <my-animatable-triangle id="orangeTriangle" on-tap="_onPressedAnimationTriangle" on-track="_onPressedAnimationTriangle"></my-animatable-triangle> -->
    
    <menu-overlay id="plain" tabindex="-1">
    <div><paper-icon-button icon="icons:close" style="float: right;" on-tap="_closePopUp"></paper-icon-button><div>
    <br><p style="text-align: center;">{{periodStartSelected}} pm to {{periodEndSelected}} pm</p>
    <p class="heading">Select Activity</p><hr style="margin-bottom:20px;">
    <div class="horizontal-section-container">
      <div>
        <div class="row">
          <div class="horizontal-section">
            <simple-menubar selected="0">
              <a role="menuitem">Work</a>
              <a role="menuitem">Sleep</a>
              <a role="menuitem">Gym</a>
              <a role="menuitem">Social</a>
              <a role="menuitem">Leisure</a>
            </simple-menubar>
          </div>
        </div>
      </div>
    </div>
    <p class="heading">Select Emotion</p><hr style="margin-bottom:20px;">
    <div>
    <my-animatable class="menuitem-floating"></my-animatable>
    <my-animatable class="menuitem-floating"></my-animatable>
    <my-animatable class="menuitem-floating"></my-animatable>
    </div>
    <div>
    <my-animatable-triangle class="menuitem-floating"></my-animatable-triangle>
    <my-animatable-triangle class="menuitem-floating"></my-animatable-triangle>
    <my-animatable-triangle id="orange" class="menuitem-floating"></my-animatable>
    </div>
    </menu-overlay>

  </template>

  <script>

    Polymer({

      is: 'my-input',
      properties: {
          periodEndSelected: {
            type: Number,
            value: 0,
            notify: true,
            observer: '_periodEndChanged' 
          },
          periodStartSelected: {
            type: Number,
            value: 0,
            notify: true,
            observer: '_periodStartChanged' 
          }
      },
      _periodStartChanged: function(periodStartSelected) {
        
        },
      _periodEndChanged: function(periodEndSelected) {
        console.log("MY-INPUT _periodEndChanged");
        this.createPopUp();
        },
      createPopUp: function() {
        this.$.plain.open();
      },
      _closePopUp: function() {
        console.log("close");
        this.$.plain.close();
      },
      printEndValue: function() {
        console.log("printEndValue: "+this.periodEndSelected);
      },
      _onPressedAnimationTriangle: function(event) {
        var node = this.$.orangeTriangle;
        console.log("_onPressedAnimation");
        var st = window.getComputedStyle(node, null);
        var transformValues = st.getPropertyValue("-webkit-transform") ||
         st.getPropertyValue("-moz-transform") ||
         st.getPropertyValue("-ms-transform") ||
         st.getPropertyValue("-o-transform") ||
         st.getPropertyValue("transform") ||
         "Either no transform set, or browser doesn't do getComputedStyle";
        console.log("transformValues: "+transformValues);
        var values = transformValues.split('(')[1];
        values = values.split(')')[0];
        values = values.split(',');
        var scale = values[0];
        var scaleNew = ((parseFloat(scale)+0.01)*100%100)/100;
        scaleNew += 0.3;
        console.log('scaleNew: '+scaleNew);
        node.style.transform = 'scale('+scaleNew+','+scaleNew+')';
        if (node) {
          // node.animate();
          console.log("animating");
        }
      },
      _onCircleButtonClick: function(event) {
        var node = this.$.orangeTriangle;
        console.log("_onCircleButtonClick");
        node.style.transform = 'scale(0,0)';
        if (node) {
          // node.animate();
          console.log("animating");
        }
      },
      _onCircleStopClick: function(event) {
        var node = this.$.orange;
        console.log("_onCircleStopClick");
        if (node) {
          console.log("cancelling animation");
          node.cancelAnimation();
        }
      }
    });

  </script>

</dom-module>
